---
title: Dynamic row-level security embedding with SSAS
description: Dynamic RLS embedding with on-premises Analysis services 
author: mberdugo
ms.author: monaberdugo
ms.reviewer: mberdugo
editor: mberdugo
ms.service: powerbi
ms.subservice: powerbi-developer
ms.topic: how-to
ms.date: 05/10/2022
#Customer intent: As an ISV with an on-prem dataset model, I want embed reports for my customers using RLS to maintain privacy and security.
---
# Embed a report with row-level security on an on-premises SQL Server Analysis Services (SSAS)

This article explains how to embed Power BI content that uses [**RLS** (row-level security)](embedded-row-level-security.md) from an [on-premises](pbi-glossary.md#on-premises-on-prem) *Analysis Services Tabular Model* into a standard Power BI app owns data application.

> [!NOTE]
> This article is only relevant for app owns data customers.

In this scenario, the RLS is configured on the SSAS (on-prem) model, and the Power BI engine connects to it via a [gateway](pbi-glossary.md#gateways-or-on-premises-data-gateways). The security roles and permissions are defined in the SSAS (on-prem) model, and *not* in Power BI Desktop.

To embed a report that uses RLS with an SSAS model, you need to do the following actions:

1. [Set up the environment](#set-up-the-environment)
2. [Create the report](#create-the-report)
3. [Generate an embed token](#generate-an-embed-token)

## Prerequisite

Before you start, make sure your on-prem database is set up to handle row level static or dynamic security using the *SQL Server Analysis Services (SSAS) tabular* model. For a detailed explanation on how to set up dynamic security, refer to [Implement Dynamic Security by Using Row Filters](/analysis-services/tutorial-tabular-1200/supplemental-lesson-implement-dynamic-security-by-using-row-filters).

## Set up the environment

To set up the RLS environment, you need to perform the *first four tasks* of [Implement row-level security in an on-premises Analysis Services tabular model](../../connect-data/desktop-tutorial-row-level-security-onprem-ssas-tabular.md). Keep in mind that this document is a tutorial that uses specific tables and roles as an example. You'll replace them with the tables and roles that you need.

1. [Set up the security table and define data relationships](../../connect-data/desktop-tutorial-row-level-security-onprem-ssas-tabular.md#task-1-create-the-user-security-table-and-define-data-relationship)
2. [Define roles and permissions on-prem](../../connect-data/desktop-tutorial-row-level-security-onprem-ssas-tabular.md#task-2-create-the-tabular-model-with-facts-and-dimension-tables)
3. [Create a data source on the gateway](../../connect-data/desktop-tutorial-row-level-security-onprem-ssas-tabular.md#task-3-add-data-sources-within-your-on-premises-data-gateway)
4. Add the service principal or master user as a gateway admin, or add them as a [Datasource User](/rest/api/power-bi/gateways/add-datasource-user) with a [DatasourceAccessRight](/rest/api/power-bi/gateways/add-datasource-user#request-body) of [`ReadOverrideEffectiveIdentity`](/rest/api/power-bi/gateways/add-datasource-user#datasourceuseraccessright).

5. Complete the first four steps only, of [connect to the AS engine](../../connect-data/desktop-tutorial-row-level-security-onprem-ssas-tabular.md#task-4-create-report-based-on-analysis-services-tabular-model-using-power-bi-desktop)

## Create the report

Once the environment is set up, create a *live connection* between Power BI Desktop and the SQL server and create your report.

Complete the first four steps only, of [connect to the AS engine](../../connect-data/desktop-tutorial-row-level-security-onprem-ssas-tabular.md#task-4-create-report-based-on-analysis-services-tabular-model-using-power-bi-desktop) and then create the report that you want to embed.

## Generate an embed token

To embed your report in the *embed for your customers* scenario, generate an embed token that passes the effective identity to Power BI.

The master user or service principal that generates the embed token must either be a gateway admin or have a `DatasourceAccessRight` of `ReadOverrideEffectiveIdentity` (read/override permissions). Users with override permission have a key icon next to their name.

  :::image type="content" source="media/rls-ssas/impersonate-override-permission.png" alt-text="Screenshot of a gateway member with a key icon next to their name.":::

To generate the embed token, provide the following information:

* **Username** (optional) - A valid username recognized by the SSAS that will be used as the effective identity. If no username is provided, but the token is generated by a master user, the master user's credentials are used.
* **Role** (required for RLS) - The report will only display data if the effective identity is a member of the role.

You can embed your report in your app, and your report will filter data according to the permissions of the user accessing the report.

## Considerations and limitations

* On-premises row-level security with Power BI is only available with live connection.
* The user or service principal that generates the embed token needs to be either a gateway admin or have a [DatasourceAccessRight](/rest/api/power-bi/gateways/add-datasource-user#request-body) of `ReadOverrideEffectiveIdentity`.

## Next steps

> [!div class="nextstepaction"]
>[Generate an embed token](generate-embed-token.md#row-level-security)
